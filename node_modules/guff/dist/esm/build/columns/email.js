import check from '../check'
import extension, {dropExtension} from '../extension'
import getSchemaName from '../getSchemaName'
export const up = knex =>
  extension(knex, 'citext')
    .ifNotExists()
    .schema(getSchemaName(knex))
export const down = knex =>
  dropExtension(knex, 'citext')
    .ifExists()
    .cascade()
export const args = {
  specificType: (knex, name) => [name, 'citext'],
}
export const after = (knex, {name, table}) => {
  return check(knex, table, name)
    .constraint(`char_length(:col:) <= 320 AND char_length(:col:) >= 5`)
    .and(`:col: ~ '.+@.+'`)
}
