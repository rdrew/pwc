'use strict'

var _interopRequireWildcard = require('@babel/runtime/helpers/interopRequireWildcard')

var _interopRequireDefault = require('@babel/runtime/helpers/interopRequireDefault')

exports.__esModule = true
exports.after = exports.args = exports.down = exports.up = void 0

var _check = _interopRequireDefault(require('../check'))

var _extension = _interopRequireWildcard(require('../extension'))

var _getSchemaName = _interopRequireDefault(require('../getSchemaName'))

const up = knex =>
  (0, _extension.default)(knex, 'citext')
    .ifNotExists()
    .schema((0, _getSchemaName.default)(knex))

exports.up = up

const down = knex =>
  (0, _extension.dropExtension)(knex, 'citext')
    .ifExists()
    .cascade()

exports.down = down
const args = {
  specificType: (knex, name) => [name, 'citext'],
}
exports.args = args

const after = (knex, {name, table}) => {
  return (0, _check.default)(knex, table, name)
    .constraint(`char_length(:col:) <= 320 AND char_length(:col:) >= 5`)
    .and(`:col: ~ '.+@.+'`)
}

exports.after = after
