import check from '../check'
import extension, {dropExtension} from '../extension'
import getSchemaName from '../getSchemaName'
export var up = function up(knex) {
  return extension(knex, 'citext')
    .ifNotExists()
    .schema(getSchemaName(knex))
}
export var down = function down(knex) {
  return dropExtension(knex, 'citext')
    .ifExists()
    .cascade()
}
export var args = {
  specificType: function specificType(knex, name) {
    return [name, 'citext']
  },
}
export var after = function after(knex, _ref) {
  var name = _ref.name,
    table = _ref.table
  return check(knex, table, name)
    .constraint('char_length(:col:) <= 320 AND char_length(:col:) >= 5')
    .and(":col: ~ '.+@.+'")
}
